<html>
    <head>
        
    <style>
        body {
            background-color: black;
        }
    </style>

    <!-- Access to whole xtk library -->
    <script type='text/javascript' src='loader.js'></script> 
    <script type="text/javascript" src="https://get.goXTK.com/xtk_edge.js"></script>
    
    <script>
        // Set global variables
         var SIZE = 1;
        var GAP = 0.2;
        var SELECTED_CUBE;
        
        window.onload = function() {

            r = new X.renderer3D();
            r.init();

            //console.log("Hello CS460!")

            //c = new X.cube(); // Done for Part 1

            // Sets up cascade of spheres
            for (var z=-5; z < 6; z++) {
                for (var y=-5; y < 6; y++) {
                    for(var x=-5; x < 6; x++) {
                        new_cube = new X.cube(); // Create new Cube

                        // Initialize the cube to have lengths X, Y and Z to be SIZE
                        new_cube.lengthX = SIZE;
                        new_cube.lengthY = SIZE;
                        new_cube.lengthZ = SIZE;

                        // Translations to set up block of spheres
                        new_cube.transform.translateX((SIZE + GAP) * x);
                        new_cube.transform.translateY((SIZE + GAP) * y);
                        new_cube.transform.translateZ((SIZE + GAP) * z);
                        r.add(new_cube);
}
}
}

            //r.add(c); //add cube to renderer - Part 1
            
            r.camera.position = [0, 0 ,300]; // Changes camera Position
            r.render(); //fires up renderer loop and shows cube

            r.interactor.onMouseMove = function(event){
                
                // console.log('test',event.offsetX,event.offsetY);
                cubeid = r.pick(event.offsetX,event.offsetY) ;
                if (cubeid != 0 )
                    SELECTED_CUBE = r.get(cubeid);
                //console.log(cubeid);
            };

           // Switch boolean for key 'b' to start and stop camera rotation
            var myswitch = false;
                // console.log(myswitch);

            //handling all the key actions
            window.onkeypress = function(e){
                // console.log(e);
                if (e.key == 'q'){ 
                    // console.log(e);
                    SELECTED_CUBE.visible = false; // hides selected cube
                }
                else if(e.key == 'w'){
                        console.log(e);
                        SELECTED_CUBE.color = [Math.random(), Math.random(), Math.random()]; // random colors
                }
                else if(e.key == 'e')
                    SELECTED_CUBE.transform.rotateX(10); // Rotate 10 degrees along X
                else if(e.key == 'b')
                {
                    myswitch = !myswitch; // Toggle boolean myswitch
                    //console.log(myswitch);
                    if (myswitch){
                        r.onRender = function(){
                        r.camera.rotate([1,0]); // rotate camera 1 degrees
                    };}
                    else{
                        r.onRender = function(){};
                    }
                }
                else if(e.key == 'l')
                    upload("scene.json"); // Calls upload function to load scene.json
                else if(e.key == 'o')
                    download(); // Calls download function to download scene.json    
                
                    //console.log(myswitch);        
                
            }
         }
        
    </script>
    </head>

    <body>
        
    </body>

</html>

